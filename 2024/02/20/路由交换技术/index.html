<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>数据通信 | TSH</title><meta name="author" content="Tang ShunHai"><meta name="copyright" content="Tang ShunHai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="[toc] 缩写词义ATM：asynchronous transfer mode，异步传输模式，分组交换技术 CIDR：classless inter-domain routing，无类域间路由 CRC：循环冗余校验 COE: 局端设备  CPE:  用户端设备，由ADSL modem（或ADSL路由器）和语音分离器组成 CSMA&#x2F;CD:  carrier sense multiple">
<meta property="og:type" content="article">
<meta property="og:title" content="数据通信">
<meta property="og:url" content="http://tt0066.github.io/2024/02/20/%E8%B7%AF%E7%94%B1%E4%BA%A4%E6%8D%A2%E6%8A%80%E6%9C%AF/index.html">
<meta property="og:site_name" content="TSH">
<meta property="og:description" content="[toc] 缩写词义ATM：asynchronous transfer mode，异步传输模式，分组交换技术 CIDR：classless inter-domain routing，无类域间路由 CRC：循环冗余校验 COE: 局端设备  CPE:  用户端设备，由ADSL modem（或ADSL路由器）和语音分离器组成 CSMA&#x2F;CD:  carrier sense multiple">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://jsd.012700.xyz/gh/jerryc127/CDN@latest/cover/default_bg.png">
<meta property="article:published_time" content="2024-02-20T13:41:09.000Z">
<meta property="article:modified_time" content="2024-03-21T02:59:13.814Z">
<meta property="article:author" content="Tang ShunHai">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jsd.012700.xyz/gh/jerryc127/CDN@latest/cover/default_bg.png"><link rel="shortcut icon" href="/img/avatar.jpg"><link rel="canonical" href="http://tt0066.github.io/2024/02/20/%E8%B7%AF%E7%94%B1%E4%BA%A4%E6%8D%A2%E6%8A%80%E6%9C%AF/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"距离上次更新已经过去了","messageNext":"天，文章内容或许已经过时。"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Tang ShunHai","link":"链接: ","source":"来源: TSH","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '数据通信',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-03-21 10:59:13'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 相册</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://jsd.012700.xyz/gh/jerryc127/CDN@latest/cover/default_bg.png')"><nav id="nav"><span id="blog-info"><a href="/" title="TSH"><span class="site-name">TSH</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 相册</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">数据通信</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-02-20T13:41:09.000Z" title="发表于 2024-02-20 21:41:09">2024-02-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-03-21T02:59:13.814Z" title="更新于 2024-03-21 10:59:13">2024-03-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0/%E7%9F%A5%E8%AF%86%E7%82%B9/">知识点</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">15.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>51分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="数据通信"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>[toc]</p>
<h1 id="缩写词义"><a href="#缩写词义" class="headerlink" title="缩写词义"></a>缩写词义</h1><p><strong>ATM</strong>：asynchronous transfer mode，异步传输模式，分组交换技术</p>
<p><strong>CIDR</strong>：classless inter-domain routing，无类域间路由</p>
<p><strong>CRC</strong>：循环冗余校验</p>
<p><strong>COE</strong>: 局端设备 </p>
<p><strong>CPE</strong>:  用户端设备，由ADSL modem（或ADSL路由器）和语音分离器组成</p>
<p><strong>CSMA&#x2F;CD</strong>:  carrier sense multiple access&#x2F;collision detection，载波侦听多路访问&#x2F;碰撞检测</p>
<p><strong>CSMA&#x2F;CA</strong>:  carrier sense multiple access&#x2F;collision avoidance，载波侦听多路访问&#x2F;碰撞避免</p>
<p><strong>FDDI</strong>:  光纤分布式数据接口</p>
<p><strong>GGP</strong>：gateway to gateway protocol，网关到网关协议</p>
<p><strong>ICMP</strong>:  internet control message protocol，因特网控制消息协议</p>
<p><strong>ICP</strong>:  Internet content provider</p>
<p><strong>ISDN</strong>：integrated services digital network，综合业务数字网，以拨号方式接入的数字通信网络</p>
<p><strong>ISO</strong>:  international organization for standardization</p>
<p><strong>ITU</strong>:  international telecommunication union, 国际电信联盟</p>
<p><strong>OFDM</strong>:  orthogonal frequency-division multiplexing, 正交频分复用</p>
<p><strong>PDA</strong>:  personal digital assistant</p>
<p><strong>PSTN</strong>:  public switched telephony network，公共交换电话网络，使用电路交换技术，最高带宽56Kbps</p>
<p><strong>SAP</strong>:  service access point，服务访问点</p>
<p><strong>SSH</strong>：secure shell，安全外壳                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </p>
<p><strong>TFTP</strong>：trivial file transfer protocol</p>
<p><strong>VLSM</strong>：varible length subnet mask，可变长子网掩码</p>
<p><strong>WAF</strong>：web application firewall，web应用防火墙</p>
<p><strong>WAP</strong>:  wireless application protocol</p>
<p><strong>WAPI</strong>:  wireless LAN authentication and privacy infrastructure，无线局域网鉴别和保密基础结构，WLAN的一种安全协议</p>
<h1 id="重点及陌生概念"><a href="#重点及陌生概念" class="headerlink" title="重点及陌生概念"></a>重点及陌生概念</h1><h2 id="数据通信基本概念"><a href="#数据通信基本概念" class="headerlink" title="数据通信基本概念"></a>数据通信基本概念</h2><p><strong>模拟通信：</strong>信源产生模拟数据并以模拟信道传输</p>
<p><strong>数字通信：</strong>信源产生模拟数据并以数字信号传输</p>
<p><strong>数据通信：</strong>信源产生数字数据，以模拟或数字信号传输</p>
<p><strong>码元速率</strong>：单位时间内信号波形的变换次数，即单位时间内通过信道传输的码元个数，若信号码元宽度为T秒，码元速率B&#x3D;1&#x2F;T，单位是波特（Baud），所以码元速率也叫做<strong>波特率</strong></p>
<p><strong>尼奎斯特定律：</strong>若有限无噪声信道带宽为W，则极限波特率为B&#x3D;2W</p>
<h2 id="网络状态码"><a href="#网络状态码" class="headerlink" title="网络状态码"></a><strong>网络状态码</strong></h2><blockquote>
<p>200：服务器成功返回网页</p>
<p>400：错误请求，服务器不理解请求的语法</p>
<p>401：未授权，请求要求身份验证</p>
<p>403：禁止，服务器拒绝请求</p>
<p>404：未找到，请求网页不存在</p>
<p>405：方法禁用，禁止请求中指定的方法</p>
<p>406：不接受，无法使用请求的内容特性响应请求的网页</p>
<p>500：服务器内部错误，无法完成请求</p>
<p>501：尚未实施，服务器不具备完成请求的功能</p>
<p>502：错误网关，服务器作为网关或代理，从上游服务器收到无效响应</p>
<p>503：服务不可用，服务器目前无法使用（由于超载或停机维护）</p>
<p>504：网关超时，服务器作为网关或代理，但是没有及时从上游服务器收到请求</p>
<p>505：HTTP版本不受支持，服务器不支持请求中所使用的HTTP协议版本</p>
</blockquote>
<p><strong>网络拓扑</strong>：计算机网络的物理布局</p>
<p><strong>网络拓扑模型</strong>：总线型、星型、环型、全网状(两两相连)、部分网状(没有两两相连)</p>
<p><strong>电路交换</strong>：通信双方独占数据传输通道直至通信结束，物理线路或多路复用得到的逻辑通道，具有固定带宽</p>
<p><strong>分组交换</strong>：将传输的信息划分为固定长度的分组，以分组为单位进行转发。任何用户不能长时间独占某传输路线。延迟增大，占用更多带宽资源。</p>
<p><strong>报文交换</strong>：</p>
<p><strong>带宽</strong>：一定时间范围内从一个节点到另一个节点能够传输的数据量，分为模拟带宽和数字带宽。单位<strong>bps</strong>。</p>
<p><strong>延迟</strong>：传播延迟、交换延迟、介质访问延迟、队列延迟。不可能完全消除。</p>
<blockquote>
<p>上面两个用来衡量网络性能</p>
</blockquote>
<p><strong>802.x协议族</strong>：802.3以太网标准、802.4令牌总线网标准、802.5令牌环网标准、802.11无线局域网标准……等</p>
<blockquote>
<p>802.11,  2.4GHz, 2Mbps</p>
<p>802.11b,  2.4GHz, 11Mbps</p>
<p>802.11a, 5GHz, 54Mbps</p>
<p>802.11g, 2.4GHz, 54Mbps</p>
</blockquote>
<h2 id="OSI七层模型"><a href="#OSI七层模型" class="headerlink" title="OSI七层模型"></a><strong>OSI七层模型</strong></h2><ul>
<li><p>应用层：最接近用户的一层，提供应用程序间通信，为应用程序提供网络服务，如文件传输、文件管理、电子邮件的消息处理等</p>
</li>
<li><p>表示层：处理数据格式、数据加密等，关注传输数据的语法和语义</p>
</li>
<li><p>会话层：建立、维护和管理会话，也提供双工协商、会话同步等</p>
</li>
<li><p>传输层：从会话层接收数据，传递给网络层，建立主机端到端连接、维护虚电路、差错校验、流量控制</p>
</li>
<li><p>网络层：寻址和路由选择。主要功能：编址，路由选择，拥塞控制，异种网络互联</p>
</li>
<li><p>数据链路层：提供介质访问、链路管理等。主要功能：帧同步，数据链路的建立、维持和释放，传输资源控制，流量控制，差错控制，寻址，标识上层数据</p>
</li>
<li><p>物理层：比特流传输，以比特流的形式传送来自数据链路层的数据，不理会数据的含义或格式。同样，它接收数据后直接传递给数据链路层。常见物理层传输介质主要有同轴电缆、双绞线、光纤、串行电缆、电磁波等</p>
</li>
</ul>
<p><strong>EIA&#x2F;TIA-232 DCE</strong>：端口类型，终端登录到网络设备的console(控制台)的连接方式</p>
<p><strong>DCE</strong>：data circuit-terminating equipment，数据电路终止设备，对用户端设备提供网络通信服务的接口，并提供同步DCE和DTE之间数据传输的时钟信号</p>
<p><strong>EIA&#x2F;TIA-232 DTE</strong>：端口类型，网络设备提供的AUX端口(Auxiliary，辅助端口)通常用于对设备进行远程操作和配置</p>
<p><strong>DTE</strong>：data terminal equipment，数据终端设备，接受线路时钟，获得网络通信服务的设备</p>
<p><strong>CSU</strong>:  channel service unit，通道服务单元，把终端用户和本地数字电话环路相连的数字接口设备</p>
<p><strong>DSU</strong>:  data service unit，数据服务单元，把DTE设备上的物理层接口适配到通信网络上，也负责信号时钟等功能</p>
<h2 id="周知端口"><a href="#周知端口" class="headerlink" title="周知端口"></a><strong>周知端口</strong></h2><p>0<del>65535，0</del>1023由IANA统一管理</p>
<blockquote>
<p>20:  ftp文件传输协议，默认数据口</p>
<p>21：ftp文件传输协议，控制</p>
<p>22：  TCP，SSH远程登录协议</p>
<p>23：Telnet</p>
<p>25：SMTP</p>
<p>53：DNS</p>
<p>67&#x2F;68：BootP</p>
<p>69：TFTP</p>
<p>80：HTTP</p>
<p>88：Kerberos</p>
<p>92:  NPP,network printing protocol</p>
<p>110：POP3</p>
<p>118:  SQL service</p>
<p>123：NTP</p>
<p>161：SNMP</p>
<p>162:  SNMP Trap</p>
<p>179:  BGP</p>
<p>520:  RIP</p>
</blockquote>
<p><strong>以太网帧</strong>(MAC层)：</p>
<blockquote>
<p>前导符：7个字节，10101010。用于接发方时钟同步</p>
<p>起始符：1个字节，10101011。标志一帧的开始</p>
<p>目的地址：6个字节，</p>
<p>源地址：6个字节</p>
<p>类型&#x2F;长度：2个字节</p>
<p>数据&#x2F;填充：46~1500比特</p>
<p>帧校验序号：4字节，校验内容范围：目的地址、源地址、长度、数据和填充字段</p>
</blockquote>
<p><strong>MAC地址</strong>：2进制48位，常用12位16进制数表示，24位OUI+24位EUI。MAC地址固化在网卡的ROM中，每块网卡的MAC是全球唯一、全网唯一的。一台计算机可能有多个网卡，也就有多个MAC地址</p>
<blockquote>
<p>OUI: organization unique identifier，组织唯一标识符 </p>
<p>EUI:  extended unique identifier，拓展唯一标识符</p>
</blockquote>
<p><strong>冲突域</strong>：以太网中采用总线型拓扑结构，同一时刻多个站点传输数据会产生冲突，这些站点的集合被称为冲突域</p>
<h2 id="CSMA-CD-CA"><a href="#CSMA-CD-CA" class="headerlink" title="CSMA&#x2F;CD&#x2F;CA"></a>CSMA&#x2F;CD&#x2F;CA</h2><p><strong>CSMA&#x2F;CD数据传输步骤</strong>：</p>
<ol>
<li>传输前侦听</li>
<li>忙则等待</li>
<li>传输并检测冲突</li>
<li>如果冲突发生，重传前随机等待一段时间</li>
<li>重传或夭折。重传最大次数为15，之后便停止重传</li>
</ol>
<p><strong>CSMA&#x2F;CA数据传输步骤：</strong></p>
<ol>
<li>侦听线路</li>
<li>固定帧间隔时长，空闲则继续等待一个帧间隔时长（DIFS）</li>
<li>启动定时器，DIFS后进行倒计时，时长由竞争窗口（connection window，CW）决定，是一个有限的随机数</li>
<li>发送与重传，倒计时结束开始发送，发送失败进行重传且CW递增，发送成功或次数超限则CW重置</li>
<li>其他终端状态</li>
</ol>
<blockquote>
<p>CSMA&#x2F;CD与CSMA&#x2F;CA</p>
<p>相同点：</p>
<ol>
<li>数据发送前都要侦听信道是否空闲；</li>
<li>冲突后都要使用截断二进制指数规避算法进行重传</li>
</ol>
<p>不同点：</p>
<ol>
<li>CD用于总线型以太网，CA用于无线局域网；</li>
<li>CD侦听有线信道的电压变化，CA采用能量检测、载波检测、能量载波混合检测三种方式</li>
<li>CD检测冲突，CA通过避让机制避免冲突、无法检测冲突</li>
</ol>
</blockquote>
<p><strong>全双工&#x2F;半双工</strong>：802.3的两种运行模式。CSMA&#x2F;CD仅适用于半双工</p>
<p><strong>Ad hoc网络</strong>：802.11协议定义的一种网络模式，网络中的节点具有报文转发能力，结点间的通信可能要经过多个中间点的转发（多跳）</p>
<p><strong>广域网连接方式</strong>：专线、电路交换、分组交换</p>
<p><strong>广域网数据链路层协议：</strong></p>
<ol>
<li>HDLC：high-level data link control，高级数据链路控制。面向比特，同步点到点连接，由ISO提出、SDLC协议发展而来</li>
<li>ppp：point-to-point protocol，点对点协议。提供点到点链路上封装、传递网络数据包，易于拓展、支持多种网络层协议、支持验证、可工作在同步或者异步方式下</li>
<li>帧中继：frame relay。采用虚电路技术，在链路层完成统计复用、帧透明传输和错误检测功能，传送和交换数据单元的快速分组交换技术</li>
<li>LAPB：link access procedure balanced，平衡型链路接入规程。由HDLC发展而来</li>
</ol>
<p><strong>HDLC协议</strong>：数据和控制报文以帧的标准格式传送。</p>
<ol>
<li>帧的类型：信息帧（I）用于传送用户数据、监控帧（S）用于差错控制和流量控制、无编号帧（U）用于提供对链路的建立和拆除以及多种控制功能</li>
<li>帧格式：<em>标志+地址+控制+信息+帧校验序列+标志</em><ol>
<li>标志（F）字段：01111110，标志开始和结束，所有的帧必须以F开头和结尾</li>
<li>地址（A）字段：8bits，</li>
<li>控制（C）字段：8bits，实现控制信息并标识此帧是否为信息帧</li>
<li>信息（I）字段：可以是任意的二进制比特串，未限定长度，上限由FCS字段或通信节点的缓冲容量决定，监控帧中不可含有信息字段</li>
<li>帧校验序列（TCS）字段：可以使用16位CRC，对两个标志字段之间的整个内容进行校验</li>
</ol>
</li>
<li>特点及使用限制：<ol>
<li>全双工通信</li>
<li>不依赖于任何一种字符编码集，对任何比特流进行透明传输</li>
<li>不支持验证，缺乏足够安全性</li>
<li>不支持ip地址协商</li>
<li>用于点到点的同步链路</li>
</ol>
</li>
</ol>
<h2 id="PPP协议"><a href="#PPP协议" class="headerlink" title="PPP协议"></a><strong>PPP协议</strong></h2><ul>
<li><p>数据链路层的协议，由SLIP（serial line internet protocol，串行线路网际协议）发展而来。<strong>主要</strong>用于支持全双工的异步链路，进行点到点数据传输。不是单个协议，是<strong>协议族</strong></p>
</li>
<li><p>SLIP的帧格式由IP包加上END字符（0xC0）组成，协议中为了防止线路噪声被当作数据报的内容在线上传输，通常发送端在被传送的数据报的开始处也传递一个END字符</p>
</li>
<li><p>特点：</p>
<ol>
<li>面向字符，在点到点串行链路上使用字符填充技术，支持同步和异步链路</li>
<li>通过LCP（link control protocol）部件控制数据链路的建立</li>
<li>支持验证协议族PAP（password authentication protocol）和CHAP（challenge-handshake authentication protocol，挑战-握手协议），提高安全性</li>
<li>支持各种NCP（network control protocol）</li>
<li>对网络层的地址进行协商，支持ip地址远程分配</li>
<li>无重传机制，网络开销小</li>
</ol>
</li>
</ul>
<p><strong>PPP验证</strong>：</p>
<ul>
<li>PAP验证：仅在链路初始建设阶段进行两次握手验证。验证失败不会立即断开链路，需要达到一定次数。可以单向验证和双向验证。明文传输，不安全。<ol>
<li>被验证方发送用户名和密码给主验证方</li>
<li>主验证方核实用户名和密码。正确则向被验证方发送ACK消息，允许进入下一阶段。否则发送NAK消息，通告对端验证失败</li>
</ol>
</li>
<li>CHAP验证：链路建立的开始完成三次握手验证。单向验证是指一方作为主验证方，另一方作为被验证方。双向验证就是两者叠加，双方都分别作为主验证方。安全性比PAP高。<ol>
<li>challenge：主验证方发起验证请求，将一个Nonce与本端用户名发送给被验证方</li>
<li>response：被验证方根据收到的用户名查找密码（细节略），用MD5算法对报文ID、密文、Nonce生成摘要，将此摘要与自身用户名发送至主验证方</li>
<li>Acknowledge or Not Acknowledge：验证摘要的正确性，正确则发送acknowledge，否则发送not acknowlwdge</li>
</ol>
</li>
</ul>
<p><strong>PPP MP</strong>：Multilink PPP，简称MP，将多个链路捆绑使用</p>
<ul>
<li>主要作用：<ol>
<li>提供更高带宽</li>
<li>结合DCC（Digital control center，拨号控制中心）实现动态增加或减小带宽</li>
<li>实现多条链路的负载分担</li>
<li>多条链路互为备份</li>
<li>利用分片可以降低传输延迟</li>
</ol>
</li>
<li>实现方式：<ol>
<li>配置虚拟模板接口（virtual-template，VT）</li>
<li>利用MP-group接口实现</li>
</ol>
</li>
</ul>
<p><strong>ADSL</strong>：应用最广的DSL技术，digital subscriber line，数字用户路线</p>
<ul>
<li>DSL技术分类：<ol>
<li>对称DSL技术：更适用于企业“点对点”连接应用，如大量数据传输、视频会议等。主要有HSDL（high-bit-rate DSL）、SDSL（single-line DSL）、SHDSL（single-line high-bit-rate …）</li>
<li>非对称DSL：主要有ADSL（asymmetric DSL，非对称DSL）、VDSL（very high bit rate DSL）</li>
</ol>
</li>
<li>ADSL协议标准：<ol>
<li>ADSL Full Rate</li>
<li>ADSL G.lite</li>
</ol>
</li>
<li>ADSL调制方式：<ol>
<li>CAP，数据被调制到单一载体信道，然后沿电话线发送。信号在发送前被压缩，接收端重组</li>
<li>DMT，将数据分成多个字载体信道，测试每个信道的质量，然后赋予一定的比特数，用离散快速傅里叶变换创建这些信道。比CAP获得更多的支持</li>
</ol>
</li>
</ul>
<p><strong>EPCN</strong></p>
<h2 id="TCP-IP"><a href="#TCP-IP" class="headerlink" title="TCP&#x2F;IP"></a><strong>TCP&#x2F;IP</strong></h2><p>栈的网络层位于网络接口层和传输层之间</p>
<p>网络层主要定义的协议：</p>
<ol>
<li>IP：网络层寻址、路由选择、分段及包重组</li>
<li>ARP：地址解析协议，负责把IP地址解析成物理地址。物理网络使用物理地址，不能识别ip地址。对于以太网，当IP数据包通过以太网进行传输时，ARP协议将IP地址解析成MAC地址</li>
<li>RARP：反向地址解析协议，把物理地址解析成IP地址</li>
<li>ICMP：internet control message protocol，互联网控制消息协议，定义了网络层控制和传递消息的功能，可以报告IP数据包传递过程中发生的错误、失败等信息，提供网络诊断功能，ping和tracert是ICMP的典型应用</li>
<li>IGMP：internet group management protocol，互联网组管理协议，负责管理IP组播</li>
</ol>
<p><strong>IP的作用</strong>：尽力传输网络协议，无连接、不可靠，不关心数据包内容，不维护任何前后数据包的状态信息，不能保证数据包成功到达目的地</p>
<ol>
<li>标识节点和链路：为链路分配唯一的网络号；为节点分配唯一的32位IP地址</li>
<li>寻址和转发：</li>
<li>适应各种数据链路：可以根据MTU（maximum transfer unit，最大传输单元）对IP包进行分片和重组</li>
</ol>
<p><strong>IP头格式</strong>：IP头选项不经常使用，普通IP头部长度为20B</p>
<ol>
<li>版本：4、6</li>
<li>头长度：internet header length，IHL。指IP包头部长度</li>
<li>服务类型：指IP包期望获得的服务等级，常用于QoS服务质量中</li>
<li>总长度：整个IP包的长度，包括数据部分，以字节为单位。该段长16Bit，所以IP数据包最长可达65535B。</li>
<li>标识：唯一的标识主机发送的每一个包，通常每发送一个包其值+1</li>
<li>生存时间：TTL，经过一个路由器，该值-1，当TTL&#x3D;0时，数据包被丢弃</li>
<li>协议：用来区分数据包所属的上层协议，TCP协议号是6，UDP协议号是17</li>
<li>头校验和：用于检查包的完整性。为计算校验和，将头部转换成16比特整数序列，使用反码运算相加，结果取补，并存储与校验和字段中。接收端根据收到的信息重新计算校验和。每次传输都需要重新计算校验和，因为TTL等字段在不断的变化</li>
<li>源地址和目的地址</li>
</ol>
<p><strong>IP地址</strong>：计算机内2进制32位。点分十进制表示</p>
<p><strong>路由器功能</strong>：</p>
<ol>
<li>连接分离的网络</li>
<li>链路层协议适配</li>
<li>在网络之间转发数据包：通过运行GGP协议实现，典型：RIP、OSPF、PGP等路由协议</li>
</ol>
<p><strong>IP地址</strong>：网络号+主机号</p>
<ul>
<li><p>自然分类法分类</p>
<p>A类：0开头，网络号8位，主机号24位。网络号取值1<del>126，127留作他用。地址范围：1.0.0.0</del>126.255.255.255，共2^24个</p>
<p>B类：10开头，网络号16位，主机号16位。网络号取值128<del>191，地址范围：128.0.0.0</del>191.255.255.255，共2^16个</p>
<p>C类：110开头，网络号24位，主机号8位。网络号取值192<del>223，地址范围192.0.0.0</del>223.255.255.255，共2^8个</p>
<p>D类：1110开头，网络号取值224~239，组播地址，范围244.0.0.0～239.255.255.255</p>
<p>E类：11110开头，保留地址，范围：240.0.0.0～255.255.255.255</p>
</li>
<li><p>主机号全为0的表示网络地址，代表一个网段。</p>
</li>
<li><p>全为1的表示广播地址，代表网段内所有主机。</p>
</li>
<li><p>127网络号的IP地址用于回环测试，如127.0.0.1通常代表本机。</p>
</li>
<li><p>综上，每个网段实际可用主机数要-2</p>
</li>
</ul>
<p><strong>IP子网划分</strong>：网段内部事务，外部网络不需要了解内部子网划分细节</p>
<ul>
<li><p>只根据IP地址无法确定子网号的长度，需要使用子网掩码，子网掩码中的1对应网络号和子网号，0对应主机号</p>
</li>
<li><p>默认子网掩码：</p>
<p>A类：255.0.0.0</p>
<p>B类：255.255.0.0</p>
<p>C类：255.255.255.0</p>
</li>
<li><p>子网掩码表示方法：</p>
<ol>
<li>点分十进制，如1.1.1.1&#x2F;255.255.255.0</li>
<li>斜线，如1.1.1.1&#x2F;24</li>
</ol>
</li>
<li><p>计算网内可用地址数：全0的子网的网络地址，全1的子网的广播地址</p>
<ol>
<li>将子网掩码转换为二进制，根据1的个数得到掩码位数</li>
<li>主机号位数$N&#x3D;32-$掩码位数</li>
<li>该子网内可用的主机地址数量为$2^N-2$</li>
</ol>
</li>
<li><p>子网划分降低了IP地址使用率，因为全0和全1的地址不能分配给主机使用</p>
</li>
<li><p>计算示例：</p>
<ol>
<li>将B类网络168.195.0.0划分成若干子网，要求每个子网能够容纳700台主机。主机数Y&#x3D;700，由$2^{10-1}\leq Y\leq 2^{10}$，主机号占10位，子网掩码占32-10&#x3D;22位，即11111111.11111111.11111100.00000000，根据子网掩码位数可知子网数号位数为6，那么该网络能划分成$2^6$个子网络，分别是：168.195.0.0、168.195.4.0、……、168.195.252.0，子网掩码为168.195.252.0</li>
<li>将B类网络划分成27个子网，需要的子网号位数为5，子网掩码位数为8+8+5&#x3D;21，即子网掩码为255.255.248.0，主机位数为11</li>
</ol>
</li>
</ul>
<p><strong>ARP和RARP</strong>：</p>
<p><strong>ICMP</strong>：网络层协议，定义了错误报告和其他回送给源点的关于IP数据包处理情况的消息，可以用于报告IP数据包传递过程中发生的错误、失败等消息，提供网络诊断等功能</p>
<ul>
<li>发生错误时向源端设备发送报告消息</li>
<li>包格式：IP头+ICMP消息。ICMP消息：type+code+checksum，内容根据不同的type和code变化</li>
<li>例如：type字段等于3表示目的不可达消息，同时若code等于0，表示目的网络不可达</li>
<li>常用ICMP消息类型：目的不可达（destination unreachable）、回波请求（echo request）、回波响应（echo reply）、参数问题（paramenter problem）、重定向（redirect）、源抑制（source quench）、超时（time exceeded）、时间戳请求和时间戳应答（timestamp request&#x2F;timestamp reply）</li>
</ul>
<p><strong>DHCP</strong>:  dynamic host configuration protocol，动态主机配置协议，由BOOTP（bootstrap protocol）协议发展而来，能够动态的为主机分配IP地址，并设定主机的其他信息，如默认网关、DNS服务器地址等</p>
<ul>
<li>协议的报文采用UDP方式封装</li>
<li>服务器侦听端口67，客户端侦听端口68</li>
<li>即插即用性、统一管理、有效利用IP地址资源</li>
<li>地址分配方式：<ol>
<li>手工分配，IP地址与客户端永久绑定</li>
<li>自动分配，IP地址与客户端无期限绑定，直到客户端将IP资源释放</li>
<li>动态分配，IP地址与客户端有期限绑定，到期后IP被自动释放</li>
</ol>
</li>
<li>报文：<ol>
<li>DHCP Discover，客户端起请求</li>
<li>DHCP Offer，服务器提供IP</li>
<li>DHCP Request，服务器确保无客户端使用即将分配的IP</li>
<li>DHCP Release，客户端释放IP</li>
<li>DHCP Ack&#x2F;Nak，服务器能满足需求&#x2F;不能满足</li>
<li>DHCP Decline，地址已经被分配，客户端返回</li>
<li>DHCP Inform</li>
</ol>
</li>
</ul>
<p><strong>IPv6</strong>：</p>
<ul>
<li><p>128位，16位一段分成8段，每段用十六进制表示，无效0可以省略不写，全为0时可以用“::”表示，但是一个IPV6地址中只能有一个双冒号。0:0:0:0:0:0:0:0可以表示成  ::</p>
</li>
<li><p>使用前缀、接口标识符、前缀长度，取消了网络号、主机号、子网掩码的概念，不再使用A、B、C类地址划分方法</p>
<ol>
<li><p>前缀：标识属于哪个网络</p>
</li>
<li><p>接口标识符：标识地址在网络中的具体位置</p>
</li>
<li><p>前缀长度：用于确定哪一部分是前缀、哪一部分是接口标识符</p>
<p>如：1234：5678：90AB：CDEF：ABCD：EF01：2345：6789&#x2F;64，表示前缀长度是64位，所以前缀是1234：5678：90AB：CDEF，接口标识符是ABCD：EF01：2345：6789</p>
</li>
</ol>
</li>
<li><p>地址分类：</p>
<ol>
<li>单播地址，唯一标识一个接口，类似于IPv4中的单播地址，只分配给一个节点上的一个接口，发送到单播地址的数据报文将会被发送到此地址标识的接口。根据作用范围不同分为：链路本地地址、站点本地地址、全球单播地址等</li>
<li>组播地址，多个接口可配置相同的组播地址，IPv6的组播范围是FF00：：&#x2F;8</li>
<li>任播地址，IPv6中特有的地址类型，也用来标识一组地址，但与任播地址不同的是，发送到任播地址的数据报文被此地址所标识的一组地址中距离源节点最近的一个接口。任播地址是从单播地址中分配的，并使用单播地址的格式，节点无法分别地址是单播的还是任播的，因此需要在配置时指明类型</li>
</ol>
</li>
<li><p>地址类型与格式前缀的对应关系：地址类型、格式前缀（二进制）、IPv6前缀标识</p>
<ol>
<li>未指定地址：000…0(128bits)，::&#x2F;128。不能分配给任何节点，不能作为目的地址</li>
<li>环回地址：000…1(128bits)，::1&#x2F;128。简化为::1，不能分配给任何节点，代表本机，与172.0.0.1类似</li>
<li>链路本地地址：1111111010，FE80::&#x2F;10。IPv6中，以路由器为边界的一个或多个局域网段被称为链路，使用该地址作为目的地址时数据报文不会被转发到其他链路中</li>
<li>站点本地地址：1111111011，FEC0::&#x2F;10。实际中很少使用</li>
<li>全球单播地址：其他形式，2000::&#x2F;3</li>
<li>组播地址：11111111，FF00::&#x2F;8</li>
<li>任播地址：从单播地址空间进行分配，使用单播地址的格式</li>
</ol>
</li>
<li><p>IEEE EUI-64格式：</p>
<ol>
<li>将12位的16进制MAC地址转化为二进制，得到48位MAC地址</li>
<li>在中间位置插入16进制数FFFE（1111111111111110）</li>
<li>为了确保得到的接口标识符是唯一的，将第七位（U&#x2F;L）位设置为1</li>
<li>转化为16位16进制，得到EUI-64格式的接口标识符</li>
</ol>
</li>
</ul>
<p><strong>邻居发现协议</strong>：实现地址解析、路由器发现、前缀发现、地址自动分配、地址重复检测等功能</p>
<p><strong>TCP</strong>：面向连接的、可靠的、端到端的传输层协议</p>
<ul>
<li><p>主要特点：</p>
<ol>
<li>三次握手</li>
<li>端口号</li>
<li>完整性校验</li>
<li>确认机制</li>
<li>序列号</li>
<li>窗口机制</li>
</ol>
</li>
<li><p>协议号6—-TCP：Telnet、FTP、HTTP、SMTP</p>
</li>
<li><p>协议号17–UDP：DNS、TFTP、SNMP、BootP</p>
</li>
<li><p>封装：接收应用层数据，分段，添加TCP头，添加IP头，得到IP包</p>
</li>
<li><p>TCP头格式：</p>
<ol>
<li>源端口，16位</li>
<li>目的端口，16位</li>
<li>序列号，32位，标识字节流，表示在这个报文段中的第一个数据字节</li>
<li>确认号，32位，上次成功收到的字节序列+1，只在ACK字段被设置时有效</li>
<li>数据偏移，4位，包括TCP头的大小，<em>以32位数据结构(字)为单位</em></li>
<li>保留，6位置0字段</li>
<li>控制位，共6位，每一位标志可以打开一个功能：URG、<strong>ACK</strong>、PSH、RST、<strong>SYN</strong>、<strong>FIN</strong></li>
<li>窗口，16位，目的主机告诉源主机每次期望收到的数据的字节数</li>
<li>检验和，16位，用于错误检查</li>
<li>紧急指针，16位，可选字段，指向段内的最后一个字节的位置，只有当URG字段被标记时才有效</li>
<li>选项，至少一个字节的可变长字段，标识哪个选项有效（如果有的话），如果没有的话表示这个字节为0，说明选项字段的结束，为1表示无需再有操作，为2表示下4字节包括源机器的最大段长度（MSS，maximum segment size）</li>
<li>填充，这个字段中加入额外的0，以保证TCP头是32位的整倍数</li>
<li>数据，该字段位于紧急指针和&#x2F;或选项字段之后，填充字段之前，可能比MSS 小，但绝不能对MSS大</li>
</ol>
</li>
<li><p>TCP的连接建立和拆除：<strong>三次握手建立连接</strong>，<strong>四次握手结束连接</strong></p>
</li>
<li><p>TCP可靠传输机制：</p>
<ol>
<li>传输确认：序列号+确认号</li>
<li>超时重传</li>
</ol>
</li>
<li><p>滑动窗口：大小可变，定义窗口尺寸的通告机制，增强流量控制的功能。单位：字节，16位字段。传输过程中双方通过交换窗口的大小来表达自己的剩余缓冲空间，以及下一次能够接受的最大数据量，避免缓冲区溢出。</p>
</li>
</ul>
<p><strong>UDP</strong>：无连接的、不可靠的、面向数据报的传输协议，在相对可靠的网络中进行数据传输，或用于对延迟较敏感的应用</p>
<ul>
<li><p>特点：无连接，不对收到的数据排序，对接收到的数据报不发送确认消息，传输速度比TCP快、开销较少</p>
</li>
<li><p>缺乏拥塞控制机制</p>
</li>
<li><p>数据封装：接受应用层数据，分段，添加UDP头，添加IP头</p>
</li>
<li><p>UDP首部各字段：</p>
<ol>
<li>源端口，16位</li>
<li>目的端口，16位</li>
<li>长度，16位，表明UDP头和数据在内的UDP数据报的长度，单位为字节</li>
<li>校验和，16位，基于部分IP头信息、UDP头、载荷数据的内容计算得到</li>
</ol>
</li>
</ul>
<p><strong>FTP</strong>：用于远端服务器和本地主机之间传输文件，采用client&#x2F;server的设计模式，承载在TCP协议之上</p>
<ul>
<li>文件传输时建立的TCP连接：<ol>
<li>FTP控制连接：负责客户端和服务器之间的FTP控制命令和应答信息，整个会话过程中始终打开</li>
<li>FTP数据连接：负责客户端和服务器之间的文件和文件列表的传输，需要时才建立，数据传输完毕后断开</li>
</ol>
</li>
<li>4种文件传输模式：<ol>
<li>ASCII模式：默认，适用于文本文件的传输，发送端将文件转换成ASCII码后进行传输，接收端将ASCII转换成本地文件完成接收</li>
<li>二进制模式：也称为图像文件传输模式，把文件按照比特流的方式进行传输</li>
<li><em>EBCDIC</em>模式：要求文件传输的两端都是EBCDIC系统</li>
<li></li>
</ol>
</li>
</ul>
<h2 id="VLAN"><a href="#VLAN" class="headerlink" title="VLAN"></a><strong>VLAN</strong></h2><p>：virtual local area network，虚拟局域网，将物理局域网划分成多个虚拟局域网，每一个VLAN就是一个广播域，VLAN内的主机间进行通信和在LAN内一样，但是VLAN间主机不能互通，将数据帧限制在一个VLAN内</p>
<ul>
<li><p>主要目的：<strong>划分广播域</strong></p>
</li>
<li><p>VLAN技术优点：</p>
<ol>
<li>有效控制广播域范围：将广播域限制在一个VLAN范围内，广播帧不会发送到所有交换机的端口</li>
<li>增强局域网的安全性：不同VLAN内的用户不能直接通信，需要通过路由器或三层交换机等设备</li>
<li>灵活构建虚拟工作组：</li>
<li>增强网络的健壮性：</li>
</ol>
</li>
<li><p>类型：</p>
<ol>
<li>基于端口（最普遍使用，目前所有交换机都支持）</li>
<li>基于协议，如IP、IPX</li>
<li>基于子网</li>
</ol>
</li>
<li><p>技术原理：给以太网帧附加一个标签tag，标记该以太网帧能够在那个VLAN中传播，交换机转发数据帧时，不仅需要检查MAC地址来决定转发到哪个端口，还需要检查tag是否匹配</p>
</li>
<li><p>帧格式：在802.1Q标准中定义</p>
<ol>
<li><p>标准以太网帧：DA+SA+Type+Data+CRC</p>
</li>
<li><p>带有VLAN标签的帧：DA+SA+tag+Type+Data+CRC</p>
<blockquote>
<p>tag:  TPID+Priority+CFI+VLAN ID</p>
<p>TPID：两个字节，包含固定值0x8100</p>
<p>Priority：3位，指明数据帧的优先级</p>
<p>CFI:  canonical format indicator，以太网中CFI的值为0</p>
<p>VLAN ID:  12比特，一共4096个，指明自己属于哪一个VLAN</p>
</blockquote>
</li>
</ol>
</li>
<li><p>交换机根据数据帧中的标签来判定数据帧属于哪个VLAN，而VLAN标签由交换机端口在数据帧进入交换机时添加，这样一来VLAN对终端主机是透明的，它不需要知道网络中VLAN是如何划分的，也不需要识别带VLAN标签的以太网帧</p>
</li>
<li><p>一般情况下，数据帧被添加的标签VLAN ID为端口所属的VLAN的ID</p>
</li>
<li><p>跨交换机VLAN标签操作：VLAN跨交换机时传递时，要求以太网帧带有VLAN标签</p>
</li>
<li><p>Access链路类型端口：</p>
<ul>
<li>一般用于和不能识别Tag的终端（如用户主机、服务器等）相连，或者不需要区分不同VLAN成员时使用。</li>
<li>大部分情况下只能收发Untagged帧，且只能为Untagged帧添加唯一的Tag</li>
<li>交换机内部只处理Tagged帧，所以Access接口需要给接收到的数据帧添加VLAN Tag，也就必须配置缺省VLAN（PVID）</li>
<li>当Access借口接收到带有Tag的帧，并且帧中的VID与PVID相同时，Access接口也能接收处理该帧</li>
</ul>
</li>
<li><p>Trunk链路类型端口：<strong>不对VLAN标签进行剥离的端口</strong>，可以接收和发送多个VLAN的数据帧</p>
<ul>
<li>默认VLAN（PVID）是个例外，发送时Trunk端口会剥离默认VLAN帧中的标签，交换机接收到不包含标签的帧时，会加上默认VLAN标签</li>
<li>通常情况下用于跨交换机VLAN，用于连接交换机、路由器、AP以及可同时收发Tagged和Untagged帧的语音终端，可以允许多个VLAN的帧带Tag通过，但只允许一个VLAN的帧从该类接口上发出时不带Tag（即缺省VLAN）</li>
<li>交换机与交换机之间需要传输不同VLAN数据时将两个接口模式设置为trunk</li>
</ul>
</li>
<li><p>Hybrid链路类型端口：可以接收和发送多个VLAN的数据帧，<strong>还能指定对任何VLAN帧进行标签剥离操作</strong></p>
<ul>
<li>当网络中的大部分主机之间需要隔离，但是这些隔离的主机需要与另一台主机互通时，可以使用Hybrid端口</li>
<li>允许多个VLAN的报文发送时不带Tag</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>缺省VLAN</strong>：</p>
<ul>
<li>Access端口只属于一个VLAN，所以它的缺省VLAN就是它所在的VLAN</li>
<li>trunk和Hybrid端口属于多个VLAN，所以需要设置缺省VLAN ID，缺省情况下，Hybrid端口和Trunk端口的缺省VLAN为VLAN 1</li>
<li>如果设置了缺省VLAN ID，当端口接收到不带VLAN ID的的报文后，则将报文转发到属于缺省VLAN的端口，当端口接收到带有Tag的报文时，如果该报文的VLAN ID与端口的缺省VLAN ID相同，则端口会将报文的Tag去掉，再发送该报文</li>
</ul>
<blockquote>
<p>注：华为将缺省VLAN称为PVID Vlan，思科称为Native Vlan</p>
</blockquote>
</li>
<li><p><strong>交换机接口出入数据处理过程：</strong></p>
<ol>
<li>Access端口收报文：判断是否有VLAN信息，如果没有则打上端口的PVID，并进行转发，如果有则直接丢弃</li>
<li>Access端口发报文：将报文的VLAN信息剥离，直接发送出去</li>
<li>trunk端口收报文：判断是否有VLAN信息，如果没有则打上端口的PVID并进行转发，如果有则判断该trunk端口是否允许该VLAN的数据进入，如果可以则转发，否则丢弃</li>
<li>trunk端口发报文：比较PVID和将要发送报文的VLAN信息，如果两者相等则剥离VLAN信息再发送，如果不相等则直接发送</li>
<li>hybrid端口收报文：判断是否有VLAN信息，如果没有则打上端口的PVID，并进行转发，如果有则判断该hybrid端口是否允许该VLAN的数据进入，如果可以则转发，否则丢弃。（此时端口上的untag配置不用考虑，因为untag配置只对发送报文时起作用）</li>
<li>hybrid端口发报文：<ul>
<li>判断该VLAN在本端口的属性，<code>display interface</code>可以看到该端口对哪些VLAN是untag，哪些是VLAN是tag</li>
<li>如果是untag则剥离VLAN信息，再发送，如果是tag则直接发送</li>
</ul>
</li>
</ol>
</li>
</ul>
<h2 id="VLAN间通信"><a href="#VLAN间通信" class="headerlink" title="VLAN间通信"></a>VLAN间通信</h2><ul>
<li>通过子接口实现</li>
<li>vlan-if实现</li>
</ul>
<h2 id="VXLAN"><a href="#VXLAN" class="headerlink" title="VXLAN"></a>VXLAN</h2><h3 id="报文格式"><a href="#报文格式" class="headerlink" title="报文格式"></a>报文格式</h3><p><code>outer MAC Header</code>+<code>outer IP Header</code>+<code>UDP Header</code>+<code>VXLAN Header</code>+<code>Original Ethernet Frame</code></p>
<ul>
<li><p>VXLAN Header：8字节，包含24比特的VNI字段，用来定义VXLAN网络中不同的租户，此外还包含VXLAN Flags，8比特，取值为00001000和两个保留字段（分别为24比特和8比特）</p>
<blockquote>
<p>VXLAN Flags：8比特</p>
<p>Reserved：24比特</p>
<p>VNI：24</p>
<p>Reserved：8</p>
</blockquote>
</li>
<li><p>UDP Header：VXLAN头</p>
</li>
</ul>
<h2 id="CDP思科发现协议"><a href="#CDP思科发现协议" class="headerlink" title="CDP思科发现协议"></a><strong>CDP思科发现协议</strong></h2><p>：Cisco discovery protocol，和LLDP都是可以在802.3环境（以太网）中运行的邻居发现协议，CDP是Cisco专有协议，而LLDP是开放标准协议，两者几乎完成同样的功能。类似的还有华为&#x2F;H3C的NDP协议</p>
<p><strong>LLDP</strong>：link layer discovery protocol，802.1ab中定义的链路层发现协议，一种标准的二层发现协议，可将本端设备的管理地址、设备标识、接口标识等信息组织起来并发布给自己的邻居，邻居收到这些信息后将其以标准的管理信息库MIB（management information base）的形式保存起来，以供网络管理系统查询及判断链路的通信状况</p>
<ul>
<li><p>通过LLDP获取的设备二层信息能够快速获取相连设备的拓扑状态；显示出客户端、交换机、路由器、应用服务器以及网络服务器之间的路径；检测设备间的配置冲突、查询网络失败的原因。</p>
</li>
<li><p>原理框图：<img src="C:\Users\糖\AppData\Roaming\Typora\typora-user-images\image-20230824090535211.png" alt="image-20230824090535211"></p>
</li>
<li><p>实现原理：</p>
<ol>
<li>LLDP模块通过LLDP代理与设备上物理拓扑MIB、实体MIB、接口MIB以及其他类型MIB的交互，来更新自己的LLDP本地系统MIB，以及本地设备自定义的LLDP拓展MIB</li>
<li>将本地设备信息封装成LLDP帧发送给远端设备</li>
<li>接收端设备发过来的LLDP帧，更新自己的LLDP远端系统MIB，以及远端设备自定义的LLDP拓展MIB</li>
<li>通过了LDP代理收发LLDP帧，设备能够知道远端设备的信息，如连接的是远端设备的哪个接口、MAC地址信息等</li>
</ol>
</li>
<li><p>LLDP代理的任务：</p>
<ol>
<li>维护LLDP本地系统MIB和远端MIB</li>
<li>本地设备信息发生变化时向远端设备发送信息，没有变化时定期发送</li>
<li>识别处理收到的LLDP帧</li>
<li>LLDP本地系统MIB或远端系统MIB状态发生变化时向网管发送警告</li>
</ol>
</li>
<li><p>LLDP报文结构：DA+SA+Type+LLDPDU+FCS</p>
<ul>
<li><p>封装有LLDP数据单元LLDPDU的以太网报文称为LLDP报文</p>
</li>
<li><p>各字段含义：</p>
<ol>
<li>DA：6字节，destination mac address，目的MAC地址，为固定的组播MAC地址0x0180-C200-000E</li>
<li>SA：6字节，source mac address，源MAC地址，发送端</li>
<li>Type：2字节，LLDP报文中该字段为0x88CC</li>
<li>LLDPDU：46-1500字节，信息交换主体</li>
<li>FCS：4字节，帧校验序列</li>
</ol>
</li>
<li><p>LLDPDU：<strong>Chassis ID TLV</strong>+<strong>Port ID TLV</strong>+<strong>Time to Live TLV</strong>+Optional TLV+…+<strong>End of LLDPDU TLV</strong></p>
<p>Time to Live TLV字段为0时称为shutdown报文，shutdown报文不包含任何可选TLV</p>
</li>
<li><p>TLV：TLV type+TLV length+TLV value。TLV是组成LLDPDU的单元，每个TLV都代表一个信息</p>
<ul>
<li>type：7比特，End of LLDPDU TLV为0，Chassis ID TLV为1</li>
<li>length：9比特</li>
<li>Value：0-511字节，第一个字节指此TLV的子类型，剩余字节为TLV真正的值</li>
</ul>
</li>
</ul>
</li>
<li><p>LLDP组网模式：</p>
<ol>
<li>单邻居组网模式：交换机设备的接口之间或者交换机与媒体终端的接口之间是直接相连的，中间没有任何其他设备，并且每个接口只有一个邻居设备</li>
<li>多邻居组网模式：交换机设备之间不是直接相连的，并且每个接口的邻居不止一个</li>
<li>链路聚合组网模式：交换机设备的接口之间存在链路聚合，接口之间直接相连，链路聚合之间的每个接口只有一个邻居设备</li>
</ol>
</li>
</ul>
<h2 id="STP生成树协议"><a href="#STP生成树协议" class="headerlink" title="STP生成树协议"></a><strong>STP生成树协议</strong></h2><p>：STP, spanning tree protocol，在802.1D中定义，为了避免广播风暴，需要保证网络中不存在路径回环，所有链路应该组成一棵无回环的树。</p>
<ul>
<li>STP通过阻断冗余链路使一个有回环的桥接网路形成一个无回路的树型拓扑结构，通过将环路上的某些端口设置为阻塞状态，不允许数据帧通过。</li>
<li>桥协议数据单元：BPDU，bridge protocol data unit<ul>
<li>配置BPDU：configuration BPDU，进行生成树计算和维护生成树拓扑的报文<ol>
<li>桥根ID：root ID，由根桥的<strong>优先级</strong>（2字节）和<strong>MAC地址</strong>（6字节）组成，通过比较BPDU中根的桥ID，STP最终决定谁是根桥</li>
<li>根路径开销：root path cost，到根桥的最小路径开销。端口路径开销的默认值及取值范围由选定的路径开销算法决定，路径开销与端口的带宽成反比。</li>
<li>指定桥ID：designed bridge ID，生成或转发BPDU的桥ID，由桥优先级和MAC地址组成。</li>
<li>指定端口ID：designed port ID，发送BPDU的端口ID，由端口优先级和端口索引号组成</li>
</ol>
</li>
<li>比较次序：1&gt;2&gt;3&gt;4。<strong>值越小越优先</strong>。</li>
<li>TCN BPDU：topology change notification BPDU，当拓扑结构发生变化时，用来通知相关设备拓扑结构发生变化的报文</li>
</ul>
</li>
<li>各台设备的各个端口在初始时都会生成以自己为根桥的配置消息，根路径开销为0，指定桥ID为自身设备ID，指定端口为本端口，然后将配置消息发送给各个设备，同时也会收到其他设备的配置信息，交换机根据这些信息进行生成树计算，选举根桥，决定端口角色<ul>
<li>整个STP中选举唯一的一个根桥</li>
<li>对于所有非根桥，选举出根端口和指定端口，负责流量转发</li>
</ul>
</li>
<li>根桥选举：例如有三个交换机SWA、SWB、SWC，他们的桥ID为0.0000-0000-0000、16.0000-0000-0001、0.0000-0000-0002，首先排除SWB，然后排除SWC，SWA被选为根桥</li>
<li>桥的MAC地址在网络中是唯一的，因此桥ID也是唯一的</li>
<li>&#x3D;&#x3D;确定阻塞状态的过程：&#x3D;&#x3D;<ol>
<li>根桥（根交换机）上所有的端口为指定端口，都不会被阻塞。</li>
<li>为每个非根桥选择开销最小的那个端口作为根端口，该端口到根桥的路径是该网桥到根桥的最佳路径</li>
<li>为每个物理段选择根路径开销最小的那个网桥作为指定桥，该指定桥到该物理段的端口作为指定端口，负责所在物理段上的数据转发</li>
<li>既不是指定端口也不是根端口的端口，是Alternate端口（非指定端口），置于阻塞状态，不转发普通以太网数据帧</li>
</ol>
</li>
<li>对于非根桥，只需要一个端口作为根端口，如果有两个或者更多根端口，处于转发状态时就会形成回路，因为根桥的所有端口都是指定端口，处于转发状态</li>
<li>STP中，一个物理段只需要一个指定端口，比如两个交换机之间的链路</li>
<li>不能成为指定端口和根端口端口，将处于阻塞状态，不能转发数据帧</li>
<li>通常链路开销与带宽成反比</li>
<li>当非根桥上的不同的端口到达根桥的路径开销相同时，根据桥ID来确定端口的角色。连接到上游指定桥ID最小的端口被选举为根端口。在一个物理段上确定指定桥和指定端口时也是如此</li>
<li>当根路径开销和上游指定桥ID都相同的情况下，根据端口ID来确定端口角色，所连接到的上游指定端口ID最小的作为根端口</li>
<li>端口ID：索引号+端口优先级，优先比较端口优先级，优先级小的端口优先，然后索引号小的端口优先</li>
<li>端口状态：在802.1D协议中，共有5种端口角色<ol>
<li>Disabled：失效，不接受和转发任何报文，物理失效或人为设置</li>
<li>Blocking：（华为：discarding）可以接收BPDU报文，然后交给CPU处理，但是不能转发数据，不发送配置消息，不能进行地址学习</li>
<li>Listening：不参与数据转发，不进行地址学习，但是可以接收并发送BPDU配置消息</li>
<li>Learning：不能转发数据，但可以学习MAC地址，并可以接收、转发BPDU配置消息</li>
<li>Forwarding：可以转发任何数据，进行地址学习，接收、处理、转发BPDU配置消息</li>
</ol>
</li>
<li>当一个端口由于拓扑发生变化而不再是根端口或指定端口时立即进入Blocking状态</li>
<li>当一个端口被选为根端口或指定端口时，从Blocking状态进入Listening状态，经理Forward Delay时间后进入Learning状态，经历Forward Delay时间后进入Forwarding状态。Forward Delay时间的设置可以保证当拓扑发生改变时，新的配置消息能够传遍整个网络，从而避免由于网络未收敛导致环路的形成</li>
</ul>
<p><strong>RSTP</strong>：802.1w中定义，最终合入802.1D 2004。</p>
<ul>
<li>由于STP中的一个端口被选为根端口或指定端口时，需要两倍Forward Delay时间才能成为Forwarding状态，时延较长</li>
<li>RSTP针对点对点链路</li>
<li>端口被选为根端口时的切换时间为一个CPU处理的延时</li>
<li>非边缘端口启用时发送握手消息，等待边缘端口的同意消息，被同意后成为转发状态</li>
<li>如果是非点对点链路，端口的恢复时间与STP无异</li>
<li>边缘端口无延时恢复</li>
<li>网桥无法判定端口是否为边缘指定端口，只有管理员可以确定</li>
</ul>
<p><strong>MSTP</strong>：802.1s中定义，后被合入802.1 Q 2003</p>
<ul>
<li>802.1Q封装的Trunk链路上一般同时存在多个VLAN，而每个VLAN实质上是一个独立的两层交换网络，为了给所有的VLAN提供环路避免和冗余备份功能，必须为所有的VLAN提供生成树计算</li>
<li>可实现VLAN级&#x3D;&#x3D;负载均衡&#x3D;&#x3D;</li>
<li>在网络中定义多个生成树实例，每个实例包含多个VLAN，每个实例维护自己独立的生成树</li>
<li>不同的VLAN具有不同的生成树拓扑，不同VLAN在同一端口可以具有不同的状态，从而实现VLAN一级的负载分担</li>
</ul>
<p><strong>STP、RSTP、MSTP</strong>三者比较：</p>
<ul>
<li><p>STP在交换网络中形成一棵无环路的树，解决环路故障并实现冗余备份</p>
</li>
<li><p>RSTP在STP的基础上，通过使根端口快速进入转发状态，使用握手机制和设置边缘端口的方法提供更快的收敛速度</p>
</li>
<li><p>MSTP可以在大规模、多VLAN环境下形成生成树实例，高效提供多VLAN负载均衡</p>
</li>
<li><p>MSTP兼容STP和RSTP</p>
<blockquote>
<p>在可能的情况下，尽量使用MSTP来避免环路问题</p>
</blockquote>
</li>
</ul>
<p><img src="C:\Users\tsh00\AppData\Roaming\Typora\typora-user-images\image-20231206160645585.png" alt="image-20231206160645585" style="zoom:35%;" /><img src="C:\Users\tsh00\AppData\Roaming\Typora\typora-user-images\image-20231206160718541.png" alt="image-20231206160718541" style="zoom:33%;" /></p>
<p><img src="C:\Users\tsh00\AppData\Roaming\Typora\typora-user-images\image-20231206161059545.png" alt="image-20231206161059545" style="zoom:33%;" /><img src="C:\Users\tsh00\AppData\Roaming\Typora\typora-user-images\image-20231206161155315.png" alt="image-20231206161155315" style="zoom:33%;" /></p>
<p><img src="C:\Users\tsh00\AppData\Roaming\Typora\typora-user-images\image-20231206161339968.png" alt="image-20231206161339968" style="zoom:33%;" /><img src="C:\Users\tsh00\AppData\Roaming\Typora\typora-user-images\image-20231206161540761.png" alt="image-20231206161540761" style="zoom:33%;" /><img src="C:\Users\tsh00\AppData\Roaming\Typora\typora-user-images\image-20231206161654979.png" alt="image-20231206161654979" style="zoom:33%;" /><img src="C:\Users\tsh00\AppData\Roaming\Typora\typora-user-images\image-20231206162300112.png" alt="image-20231206162300112" style="zoom:33%;" /></p>
<h2 id="dtp协议"><a href="#dtp协议" class="headerlink" title="dtp协议"></a><strong>dtp协议</strong></h2><p>思科动态中继协议，是VLAN组中思科所有协议，主要用于协商两台设备间链路上的中继过程以及封装802.1Q类型，只能用于交换机之间建立<strong>trunk</strong>链路，并且每隔30s发送DTP帧。</p>
<p>dtp采用协商的方式来决定是否将接口配置为trunk，在需要使用trunk链路时，通常是手工配置接口模式，并手工指定trunk封装协议</p>
<p><strong>当交换机与交换机的接口相连时，多数都需要配置为trunk模式，交换机与主机相连时，需要配置为access模式</strong></p>
<p>中继协议有很多不同类型，如果端口被设置为trunk端口，那么该端口具有自动中继功能，在某些情况下甚至具有协商端口中继类型的功能。这种与其他设备之间进行的协商中继方法的过程被称为<strong>动态中继技术</strong></p>
<p>中继链路的两端最好都能理解它们是中继端口，否则它们将中继帧视为正常帧</p>
<h2 id="端口镜像"><a href="#端口镜像" class="headerlink" title="端口镜像"></a>端口镜像</h2><p>分类：</p>
<ol>
<li><p>基于端口的镜像：将被检控的端口上的数据复制到指定的监控端口，对数据进行分析和监视。</p>
<ol>
<li><p>本地镜像：监控主机与观察端口直接相连。</p>
</li>
<li><p>远程镜像：监控主机与观察端口所在的设备之间通过二层或三层网络相连。</p>
<p>1）二层端口镜像(RSPAN: Remote Switched Port Analyser)：将镜像端口的报文封装VLAN，然后通过观察端口将报文在远程镜像VLAN中进行广播，远程设备收到报文后，比较报文的VLAN ID，如果相同则将该报文转发到远程观察端口。</p>
<p>2）三层端口镜像(ERSPAN: Encapsulated Remote SPAN)：使用GRE报文头封装和解封装镜像报文，使得镜像报文可以穿透三层网络，从而实现镜像端口所在的设备与观察端口所在的设备之间通过三层网络相连时的端口镜像。</p>
</li>
</ol>
</li>
<li><p>基于流的镜像：将匹配访问控制列表规则的业务流复制到指定的监控端口，用于报文的分析和监视。</p>
<ol>
<li>流镜像到接口：将报文复制到观察端口。</li>
<li>流镜像到CPU：将报文复制到CPU。</li>
</ol>
</li>
</ol>
<h2 id="链路聚合"><a href="#链路聚合" class="headerlink" title="链路聚合"></a>链路聚合</h2><p>通过链路聚合技术，将多条以太网链路进行捆绑，不仅能提升带宽，还能提供负载分担和链路冗余，还不需要对硬件进行升级。</p>
<p>链路聚合（Link Aggregation）是将一组物理接口捆绑在一起作为一个逻辑接口来增加带宽的一种方法，又称多接口负载均衡组（Load Sharing Group）或链路聚合组（Link Aggregation Group），协议标准IEEE 802.3ad。</p>
<p>工作方式：</p>
<ol>
<li><p>手工负载分担</p>
<ul>
<li><p>允许在聚合组中手工加入多个成员接口，所有的接口均处于转发状态，分担负载的流量。S9300支持的负载分担方式包括目的MAC、源MAC、源MAC异或目的MAC、源IP、目的IP、源IP异或目的IP和增强模式。</p>
</li>
<li><p>Eth-Trunk的创建、成员的加入都需要手工配置完成，没有LACP（Link Aggregation Control Protocol）协议报文的参与。</p>
</li>
<li><p>通常应用在对端设备不支持LACP协议的情况下。</p>
</li>
</ul>
</li>
<li><p>静态LACP</p>
<img src="C:\Users\tsh00\AppData\Roaming\Typora\typora-user-images\image-20231212165833562.png" alt="image-20231212165833562" style="zoom:43%;" /></li>
</ol>
<h2 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a><strong>DNS</strong></h2><ul>
<li>域名服务器类型：<ol>
<li>本地域名服务器：</li>
<li>根域名服务器：</li>
<li>授权域名服务器：</li>
<li>主域名服务器：</li>
<li>辅助域名服务器：</li>
</ol>
</li>
</ul>
<h2 id="静态路由"><a href="#静态路由" class="headerlink" title="静态路由"></a>静态路由</h2><ul>
<li><p>静态路由配置</p>
<ol>
<li><p>关联下一跳IP（√）</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip route<span class="literal">-static</span> 网络号 掩码 下一跳IP</span><br></pre></td></tr></table></figure>
</li>
<li><p>关联出接口<em>（不常用）</em></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip route<span class="literal">-static</span> 网络号 掩码 出接口</span><br></pre></td></tr></table></figure>
</li>
<li><p>关联出接口和下一跳IP（√）</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip route<span class="literal">-static</span> 网络号 掩码 出接口 下一跳IP</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>默认路由（缺省路由），匹配任意的子网</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip route<span class="literal">-static</span> <span class="number">0.0</span>.<span class="number">0.0</span> <span class="number">0.0</span>.<span class="number">0.0</span> 下一跳IP</span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip route<span class="literal">-static</span> <span class="number">0.0</span>.<span class="number">0.0</span> <span class="number">0</span> 下一跳IP</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="动态路由"><a href="#动态路由" class="headerlink" title="动态路由"></a>动态路由</h2><ul>
<li>分类1<ol>
<li>距离矢量协议：RIP、BGP</li>
<li>链路状态协议：OSPF、IS-IS</li>
</ol>
</li>
<li>分类2<ol>
<li>IGP：RIP、OSPF、IS-IS</li>
<li>EGP：BGP</li>
</ol>
</li>
</ul>
<h2 id="OSPF"><a href="#OSPF" class="headerlink" title="OSPF"></a>OSPF</h2><p>open shortest path first，开放最短路径优先协议，一种链路状态路由协议，在RFC 2328中描述。</p>
<h3 id="router-id"><a href="#router-id" class="headerlink" title="router id"></a>router id</h3><p>运行OSPF协议必须存在router id，32比特无符号整数，是一台路由器在自治系统中的唯一标识</p>
<p>router id的两种设定方式：</p>
<ol>
<li>命令行</li>
<li>协议自动选取：设备从当前接口的ip地址中自动选取一个作为router id，选取的顺序是：<ul>
<li>优先从Loopback地址中选择最大的IP地址作为router id</li>
<li>如果没有配置Loopback接口，则在接口地址中选择最大的IP地址作为router id</li>
</ul>
</li>
</ol>
<p>路由器运行了OSPF并确定了router id后，如果该router id对应的接口down或者接口消失（undo interface loopback [number]）或者出现更大的IP地址，router id将保持，只有重新配置系统的router id或者OSPF的router id并重新启动OSPF进程后，才会进行router id的重新选取。</p>
<h3 id="路由器类型"><a href="#路由器类型" class="headerlink" title="路由器类型"></a>路由器类型</h3><p>![download](D:\OneDrive - USTC\工作\瑞菱\blog\public\img\download.png)</p>
<ul>
<li>区域内路由器：internal router，该类设备的所有接口都属于同一个OSPF域</li>
<li><strong>ABR</strong>：Area Border Router，区域边界路由器，该类设备可以同时属于两个以上区域，但其中一个必须是骨干区域，ABR用来连接骨干区域和非骨干区域，它与骨干区域之间可以是物理连接，也可以是逻辑连接</li>
<li><strong>BR</strong>：Backbone router，骨干路由器，该类设备至少有一个接口属于骨干区域，所有的ABR和位于Area0的内部设备都是骨干路由器</li>
<li><strong>ASBR</strong>：AS Boundary Router，自治系统边界路由器，与其他AS交换路由信息的设备，ASBR并不一定位于AS的边界，它可能是区域内设备，也可能是ABR。只要一台OSPF设备引入了外部路由的信息，它就成为ASBR</li>
</ul>
<h3 id="路由类型"><a href="#路由类型" class="headerlink" title="路由类型"></a>路由类型</h3><ul>
<li><p>Intra Area：区域内路由</p>
</li>
<li><p>Inter Area：区域间路由</p>
</li>
<li><p>第一类外部路由：Type1 External，可信程度高一些，计算出的外部路由的开销与自治系统内部的路由开销是相当的，并且和OSPF自身路由的开销具有可比性。<strong>到第一类外部路由的开销</strong>&#x3D;<strong>本设备到相应的ASBR的开销</strong>+<strong>ASBR到该路由目的地址的开销</strong>。</p>
</li>
<li><p>第二类外部路由：Type2 External，可信程度低一些，所以OSPF协议认为从ASBR到自治系统之外的开销远远大于在自治系统之内到达ASBR的开销。所以，OSPF计算路由开销时只考虑ASBR到自治系统之外的开销，即<strong>到第二类外部路由的开销</strong>&#x3D;<strong>ASBR到该路由目的地址的开销</strong>。</p>
</li>
<li><p>protocol:</p>
<ol>
<li>O_INTRA:  ospf intra area</li>
<li>O_INTER:  ospf inter area</li>
<li>O_ASE1:  ospf external type 1</li>
<li>O_ASE2:  ospf external type2</li>
<li>O_NSSA1:  ospf NSSA external type 1</li>
<li>O_NSSA2:  ospf NSSA external type 2</li>
<li>O_SUM:  ospf summary</li>
<li>IS_L1:  IS-IS level-1</li>
<li>IS_L2:  IS-IS level-2</li>
<li>IS_SUM:  IS-IS summary</li>
</ol>
</li>
</ul>
<h2 id="BGP"><a href="#BGP" class="headerlink" title="BGP"></a>BGP</h2><p>border gateway protocol，边界网关路由协议。</p>
<p>BGP功能：</p>
<ol>
<li>承载大批量的路由前缀</li>
<li>支撑MPLS&#x2F;VPN的应用，传递客户VPN路由</li>
<li>具备强大的路由策略能力，定义了丰富的路径属性</li>
<li>支持多协议的拓展</li>
</ol>
<ul>
<li><p>自治系统（Autonomous System，AS）, a collection of IP networks and routers under the control of one entity。在一个实体管辖下的拥有相同选路策略的IP网络。</p>
</li>
<li><p>BGP网络中的每一个AS都被分配一个唯一的AS号，用于区分不同的AS。AS号分为2字节AS号和4字节AS号，其中2字节AS号的范围为1<del>65535，4字节AS号的范围为1</del>4294967295。支持4字节AS号的设备能够与支持2字节AS号的设备兼容。</p>
</li>
<li><p>中国电信163AS号：4134</p>
</li>
<li><p>中国电信CN2 AS号：4809</p>
</li>
<li><p>中国网通AS号：9929</p>
</li>
</ul>
<p><strong>IGP</strong>：自治系统内部进路由信息交换，如协议RIP、OSPF、IS-IS</p>
<p><strong>EGP</strong>：自治系统之间进行路由信息交换，如BGP</p>
<p><strong>协议特征</strong>：</p>
<ol>
<li>使用TCP为传输层协议，端口号为179，BGP路由器之间基于TCP建立BGP会话，对等体之间无需直连。</li>
<li>运行BGP的路由器称为BGP Speaker，两台路由器需建立对等体关系（邻居关系）才能交互BGP路由，存在两种类型的BGP对等体关系：IBGP和EBGP。</li>
<li>在BGP对等体关系建立完成后，BGP路由器只发送增量更新或触发更新，不会周期性更新。</li>
</ol>
<p><strong>报文类型</strong>：&#x3D;&#x3D;L2 Header&#x3D;&#x3D;+&#x3D;&#x3D;IP Header&#x3D;&#x3D;+&#x3D;&#x3D;TCP Header&#x3D;&#x3D;+&#x3D;&#x3D;BGP Packets&#x3D;&#x3D;+&#x3D;&#x3D;FCS&#x3D;&#x3D;</p>
<p>BGP Packets:  &#x3D;&#x3D;BGP Header&#x3D;&#x3D;+&#x3D;&#x3D;BGP packet&#x3D;&#x3D;</p>
<p>BGP Header:  &#x3D;&#x3D;Marker&#x3D;&#x3D;（16B）+&#x3D;&#x3D;Length&#x3D;&#x3D;（2B）+&#x3D;&#x3D;Type&#x3D;&#x3D;（1B）</p>
<p>BGP packet:  &#x3D;&#x3D;OPEN&#x3D;&#x3D;、&#x3D;&#x3D;Update&#x3D;&#x3D;、&#x3D;&#x3D;Notification&#x3D;&#x3D;、&#x3D;&#x3D;Keepalive&#x3D;&#x3D;、&#x3D;&#x3D;Route-refresh&#x3D;&#x3D;</p>
<p><strong>BGP同步规则</strong></p>
<p>BGP路由器不应该使用通过IBGP对等体获悉的路由后将其通告给EBGP对等体，除非该路由是本地的或者又通过IGP获悉。</p>
<p>华为设备默认关闭BGP同步规则。</p>
<ul>
<li>路由黑洞问题</li>
<li>水平分割原则</li>
</ul>
<p><strong>BGP路径属性</strong></p>
<ul>
<li>属性分类<ol>
<li>公认属性well-known：<ul>
<li>公认必遵属性well-known mandatory：所有BGP实现都必须能识别，且在Update报文中必须携带的属性<ul>
<li>&#x3D;&#x3D;origion&#x3D;&#x3D;</li>
<li>&#x3D;&#x3D;as-path&#x3D;&#x3D;：AS号</li>
<li>&#x3D;&#x3D;next hop&#x3D;&#x3D;</li>
</ul>
</li>
<li>公认自由决定属性well-known discretionary：所有BGP实现都必须能识别，但不要求必须包含在Update报文中<ul>
<li>&#x3D;&#x3D;local-preference&#x3D;&#x3D;：用于告诉AS中的路由器哪条路径是离开AS的首选路径，值越大越优，缺省值为100，该消息只能发给IBGP对等体，不能传递给EBGP对等体。</li>
<li>&#x3D;&#x3D;atomic_aggregate&#x3D;&#x3D;</li>
</ul>
</li>
</ul>
</li>
<li>可选属性optional：<ul>
<li>可选传递的optional non-transitive：可以不支持该属性，但也应当接受包含该属性的路由并传递给其他对等体<ul>
<li>&#x3D;&#x3D;community&#x3D;&#x3D;</li>
<li>&#x3D;&#x3D;aggregator&#x3D;&#x3D;</li>
</ul>
</li>
<li>可选非传递的optional non-transitive：可以不支持该属性，不识别的BGP进程忽略包含这个属性的更新消息并且不传递给其他BGP对等体<ul>
<li>&#x3D;&#x3D;MED&#x3D;&#x3D;：multi exit discriminator，用于向外部对等体指出进入AS的首选路径，当有多个入口时，AS可以使用MED动态的影响其他AS如何选择进入的路径。<ul>
<li>MED属性值越小则BGP路由越优。</li>
<li>MED主要用于在AS之间影响BGP的选路，MED被传递给EBGP对等体后，对等体在AS内传播时会携带该MED值，但不会将该MED传递给下一个AS。</li>
<li>缺省情况下只比较来自同一对等体AS的BGP路由的MED值，如果去往同一个目的地的两条路由来自不同AS，一般情况下将不进行MED的比较。</li>
<li>只会在相邻的AS间传递，不会跨AS。</li>
<li></li>
</ul>
</li>
<li>&#x3D;&#x3D;Originator_ID&#x3D;&#x3D;</li>
<li>&#x3D;&#x3D;Cluster_list&#x3D;&#x3D;</li>
<li>&#x3D;&#x3D;*pre_value&#x3D;&#x3D;</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<h2 id="MPLS"><a href="#MPLS" class="headerlink" title="MPLS"></a>MPLS</h2><h3 id="MPLS结构"><a href="#MPLS结构" class="headerlink" title="MPLS结构"></a>MPLS结构</h3><p><img src="C:\Users\tsh00\AppData\Roaming\Typora\typora-user-images\image-20240221164321544.png" alt="image-20240221164321544"></p>
<ul>
<li>MPLS域中LSR用来转发带标签的数据包</li>
<li>LER用来转发数据包进入MPLS域，它可以转发IP包进入或者离开MPLS域</li>
<li>LSP是一个单向路径，与数据流的方向一致，LSP的入口LER称为入节点（Ingress）；位于LSP中间的LSR称为中间节点（Transit）；LSP的出口LER称为出节点（Egress）</li>
</ul>
<h3 id="MPLS标签转发"><a href="#MPLS标签转发" class="headerlink" title="MPLS标签转发"></a>MPLS标签转发</h3><p><strong>MPLS标签报文格式</strong></p>
<ul>
<li><p>在二层报头与三层报头之间插入MPLS报头，可以插入多个MPLS头部</p>
<blockquote>
<p>二层报头+MPLS报头1+MPLS报头2+MPLS报头n+IP报头+数据</p>
</blockquote>
</li>
<li><p>这种标签模式也被称为帧模式（Frame Mode）</p>
</li>
</ul>
<h2 id="ARP协议"><a href="#ARP协议" class="headerlink" title="ARP协议"></a>ARP协议</h2><p>address resolution protocol，地址解析协议，用来将IP地址解析为MAC地址的协议，主机或三层网络设备会维护一张ARP表，用于存储IP地址和MAC地址的映射关系，一般ARP表项包括动态ARP表项和静态ARP表项。</p>
<p>在局域网中，当主机或其他三层网络设备有数据要发送给另一台主机或三层网络设备时，需要知道对方的IP地址，但仅有IP地址不够，因为IP报文必须封装成帧才能通过物理网络发送，因此发送方还需要知道接收方的物理地址，即MAC地址，因此需要一个通过IP地址获取物理地址的协议，从而完成从IP到MAC地址的映射。</p>
<p><strong>分类</strong>：</p>
<ul>
<li><p>动态ARP</p>
</li>
<li><p>静态ARP</p>
</li>
<li><p>免费ARP</p>
</li>
<li><p>Proxy ARP</p>
</li>
<li><p>路由式ARP</p>
</li>
<li><p>VLAN内Proxy  ARP</p>
</li>
<li><p>VLAN间Proxy  ARP</p>
</li>
</ul>
<p>有些场景中，交换机做网关，下接二层交换机接入用户，网络中使用STP协议防环，通常二层交换机上的STP边缘端口没有配置<code>stp edged-port enable</code>，用户PC上线、下线，端口会反复up&#x2F;down，设备向STP根设备发送TC报文，网关设备频繁进行STP收敛，清除ARP，导致ARP学习异常。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">interface 接口</span><br><span class="line">arp broadcast enable</span><br></pre></td></tr></table></figure>





<h2 id="ACL"><a href="#ACL" class="headerlink" title="ACL"></a>ACL</h2><p>access control list，由一系列permit和deny语句组成的有序规则的列表，通过匹配报文的信息实现对报文的分类，本身只能够用于报文的匹配和区分，而无法实现对报文的过滤功能，针对ACL所匹配的报文的过滤功能，需要特定的机制实现，ACL只是一个匹配用的工具。</p>
<p>除了能够对报文进行匹配，还能对路由进行匹配。</p>
<p><strong>ACL的应用</strong>：</p>
<ul>
<li>过滤IP流量（可基于源、目的IP地址、协议类型、端口号等）</li>
<li>在NAT中调用</li>
<li>在路由策略中调用</li>
<li>在VPN中调用</li>
<li>在防火墙的策略部署中调用</li>
<li>在QoS中调用</li>
<li>…</li>
</ul>
<p><strong>ACL分类</strong>：</p>
<ul>
<li>基本访问控制列表：只能对IP头（源IP地址、目的IP地址、协议类型）中的源IP地址进行匹配</li>
<li>高级访问控制列表</li>
</ul>
<h2 id="NAT"><a href="#NAT" class="headerlink" title="NAT"></a>NAT</h2><p>network address translator，网络地址转换，改变IP报文中的源或目的IP地址的一种机制</p>
<p><strong>技术背景</strong></p>
<ul>
<li>IPV4地址不足</li>
<li>内网私有IP地址用户如何访问公网</li>
<li>内网私有IP地址服务器如何对公网提供服务</li>
<li>对外隐藏内网IP，同时内网特定的服务器又需要对外提供服务</li>
</ul>
<table>
<thead>
<tr>
<th align="center">优点</th>
<th align="center">缺点</th>
</tr>
</thead>
<tbody><tr>
<td align="center">节省IP地址空间</td>
<td align="center">增加转发延迟</td>
</tr>
<tr>
<td align="center">解决IP地址重叠问题</td>
<td align="center">丧失端到端寻址能力</td>
</tr>
<tr>
<td align="center">增加网络连入internet的弹性</td>
<td align="center">某些应用不支持NAT</td>
</tr>
<tr>
<td align="center">当网络变更时减少IP重编址</td>
<td align="center">需要一定内存支持动态存储NAT表项</td>
</tr>
<tr>
<td align="center">对外隐藏内网IP地址，提高安全性</td>
<td align="center">耗费CPU资源进行NAT操作</td>
</tr>
</tbody></table>
<p><strong>NAT类型</strong></p>
<ul>
<li>静态一对一映射：不能节约公网地址，但能隐藏内网IP</li>
<li>基于地址池<ol>
<li>一对一：当有用户流量到达，则从NAT地址池中取出一个地址供该私有IP访问公网，实际上仍然是一对一的映射，并没有节省IP。</li>
<li>多对一：IP和端口都会转换，这种应用可以实现多个内网共用一个公网IP，可以节省IP地址，一个公网IP，但将内网IP映射到该公网IP的不同端口。</li>
</ol>
</li>
<li>Easy ip</li>
<li>NAT server：广泛应用于内网服务器需要对外网提供服务的场景，用于将服务器映射到外网供外网访问</li>
</ul>
<h2 id="IGMP"><a href="#IGMP" class="headerlink" title="IGMP"></a>IGMP</h2><h2 id="VTP"><a href="#VTP" class="headerlink" title="VTP"></a>VTP</h2><p>VLAN Trunking Protocol，VLAN中继协议，也被称为虚拟局域网干道协议</p>
<h2 id="QoS"><a href="#QoS" class="headerlink" title="QoS"></a>QoS</h2><h2 id="IRF"><a href="#IRF" class="headerlink" title="IRF"></a>IRF</h2><p>Intelligent Resilient Framework，智能弹性架构，H3C研发的虚拟化技术，将多台设备通过物理端口连接在一起，进行必要的配置后虚拟化成一台“分布式设备”。</p>
<p><strong>优点</strong>：</p>
<ul>
<li>简化管理：可通过任意的成员设备的任意端口登录IRF系统，对IRF内所有的成员设备进行统一管理</li>
<li>高可靠性：IRF由多台成员设备组成，Master设备负责IRF的运行、管理和维护，Slave设备作为备份的同时也可以处理业务，一旦Master设备故障，系统会迅速自动选举新的Master，实现1:N的备份；此外，成员设备之间的IRF链路支持聚合功能，IRF和上层、下层设备之间的物理链路也支持聚合功能，多条链路之间可以互为备份也可以进行负载分担。</li>
<li>强大的网络拓展能力</li>
</ul>
<h3 id="IRF基本概念"><a href="#IRF基本概念" class="headerlink" title="IRF基本概念"></a>IRF基本概念</h3><ul>
<li>IRF端口：<ol>
<li>在独立运行模式下，IRF端口分为IRF-Port1和IRF-Port2</li>
<li>在IRF模式下，IRF端口分为IRF-Portn&#x2F;1和IRF-Portn&#x2F;2，其中n为设备成员的成员编号</li>
</ol>
</li>
<li>成员优先级：成员设备的一个属性，优先级越高的越可能被选为Master<ol>
<li>当前Master优先</li>
<li>成员优先级大的优先</li>
<li>系统运行时间长的优先</li>
<li>桥MAC地址小的优先</li>
</ol>
</li>
</ul>
<h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><p>物理连接、拓扑收集、角色选举、IRF的管理与维护</p>
<h3 id="多IRF冲突检测（MAD功能）"><a href="#多IRF冲突检测（MAD功能）" class="headerlink" title="多IRF冲突检测（MAD功能）"></a>多IRF冲突检测（MAD功能）</h3><p>IRF链路故障会导致一个IRF变成两个新IRF，这两个IRF拥有相同的IP地址等三层配置，引起地址冲突，需要能够检测出网络中同时存在多个IRF的机制。</p>
<p>MAD：Multi-Active Detection，多Active检测</p>
<h1 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h1></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://tt0066.github.io">Tang ShunHai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://tt0066.github.io/2024/02/20/%E8%B7%AF%E7%94%B1%E4%BA%A4%E6%8D%A2%E6%8A%80%E6%9C%AF/">http://tt0066.github.io/2024/02/20/%E8%B7%AF%E7%94%B1%E4%BA%A4%E6%8D%A2%E6%8A%80%E6%9C%AF/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://tt0066.github.io" target="_blank">TSH</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://jsd.012700.xyz/gh/jerryc127/CDN@latest/cover/default_bg.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2024/02/22/%E5%8D%8E%E4%B8%BA%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/" title="华为or华三交换机基本配置"><img class="cover" src="https://jsd.012700.xyz/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">华为or华三交换机基本配置</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Tang ShunHai</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/tt0066"><i class="fab fa-github"></i><span></span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">没啥公告，等做大做强再说</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BC%A9%E5%86%99%E8%AF%8D%E4%B9%89"><span class="toc-number">1.</span> <span class="toc-text">缩写词义</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%87%8D%E7%82%B9%E5%8F%8A%E9%99%8C%E7%94%9F%E6%A6%82%E5%BF%B5"><span class="toc-number">2.</span> <span class="toc-text">重点及陌生概念</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">2.1.</span> <span class="toc-text">数据通信基本概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E7%8A%B6%E6%80%81%E7%A0%81"><span class="toc-number">2.2.</span> <span class="toc-text">网络状态码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OSI%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B"><span class="toc-number">2.3.</span> <span class="toc-text">OSI七层模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%A8%E7%9F%A5%E7%AB%AF%E5%8F%A3"><span class="toc-number">2.4.</span> <span class="toc-text">周知端口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSMA-CD-CA"><span class="toc-number">2.5.</span> <span class="toc-text">CSMA&#x2F;CD&#x2F;CA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PPP%E5%8D%8F%E8%AE%AE"><span class="toc-number">2.6.</span> <span class="toc-text">PPP协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP-IP"><span class="toc-number">2.7.</span> <span class="toc-text">TCP&#x2F;IP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VLAN"><span class="toc-number">2.8.</span> <span class="toc-text">VLAN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VLAN%E9%97%B4%E9%80%9A%E4%BF%A1"><span class="toc-number">2.9.</span> <span class="toc-text">VLAN间通信</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VXLAN"><span class="toc-number">2.10.</span> <span class="toc-text">VXLAN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F"><span class="toc-number">2.10.1.</span> <span class="toc-text">报文格式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CDP%E6%80%9D%E7%A7%91%E5%8F%91%E7%8E%B0%E5%8D%8F%E8%AE%AE"><span class="toc-number">2.11.</span> <span class="toc-text">CDP思科发现协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#STP%E7%94%9F%E6%88%90%E6%A0%91%E5%8D%8F%E8%AE%AE"><span class="toc-number">2.12.</span> <span class="toc-text">STP生成树协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dtp%E5%8D%8F%E8%AE%AE"><span class="toc-number">2.13.</span> <span class="toc-text">dtp协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E9%95%9C%E5%83%8F"><span class="toc-number">2.14.</span> <span class="toc-text">端口镜像</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E8%81%9A%E5%90%88"><span class="toc-number">2.15.</span> <span class="toc-text">链路聚合</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DNS"><span class="toc-number">2.16.</span> <span class="toc-text">DNS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1"><span class="toc-number">2.17.</span> <span class="toc-text">静态路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1"><span class="toc-number">2.18.</span> <span class="toc-text">动态路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OSPF"><span class="toc-number">2.19.</span> <span class="toc-text">OSPF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#router-id"><span class="toc-number">2.19.1.</span> <span class="toc-text">router id</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.19.2.</span> <span class="toc-text">路由器类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.19.3.</span> <span class="toc-text">路由类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BGP"><span class="toc-number">2.20.</span> <span class="toc-text">BGP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MPLS"><span class="toc-number">2.21.</span> <span class="toc-text">MPLS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MPLS%E7%BB%93%E6%9E%84"><span class="toc-number">2.21.1.</span> <span class="toc-text">MPLS结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MPLS%E6%A0%87%E7%AD%BE%E8%BD%AC%E5%8F%91"><span class="toc-number">2.21.2.</span> <span class="toc-text">MPLS标签转发</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ARP%E5%8D%8F%E8%AE%AE"><span class="toc-number">2.22.</span> <span class="toc-text">ARP协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACL"><span class="toc-number">2.23.</span> <span class="toc-text">ACL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NAT"><span class="toc-number">2.24.</span> <span class="toc-text">NAT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IGMP"><span class="toc-number">2.25.</span> <span class="toc-text">IGMP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VTP"><span class="toc-number">2.26.</span> <span class="toc-text">VTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#QoS"><span class="toc-number">2.27.</span> <span class="toc-text">QoS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IRF"><span class="toc-number">2.28.</span> <span class="toc-text">IRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IRF%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">2.28.1.</span> <span class="toc-text">IRF基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">2.28.2.</span> <span class="toc-text">生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9AIRF%E5%86%B2%E7%AA%81%E6%A3%80%E6%B5%8B%EF%BC%88MAD%E5%8A%9F%E8%83%BD%EF%BC%89"><span class="toc-number">2.28.3.</span> <span class="toc-text">多IRF冲突检测（MAD功能）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%93%E5%B0%BE"><span class="toc-number">3.</span> <span class="toc-text">结尾</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/03/21/CTFHUB%E7%AC%94%E8%AE%B0/" title="CTFHUB笔记"><img src="https://jsd.012700.xyz/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CTFHUB笔记"/></a><div class="content"><a class="title" href="/2024/03/21/CTFHUB%E7%AC%94%E8%AE%B0/" title="CTFHUB笔记">CTFHUB笔记</a><time datetime="2024-03-21T00:31:08.000Z" title="发表于 2024-03-21 08:31:08">2024-03-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/18/%E6%8A%80%E8%83%BD/" title="技能"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="技能"/></a><div class="content"><a class="title" href="/2024/03/18/%E6%8A%80%E8%83%BD/" title="技能">技能</a><time datetime="2024-03-18T08:09:31.000Z" title="发表于 2024-03-18 16:09:31">2024-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/18/OSPF%E4%B8%93%E9%A2%98/" title="OSPF专题"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OSPF专题"/></a><div class="content"><a class="title" href="/2024/03/18/OSPF%E4%B8%93%E9%A2%98/" title="OSPF专题">OSPF专题</a><time datetime="2024-03-18T01:47:15.000Z" title="发表于 2024-03-18 09:47:15">2024-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/16/wx-miniprogram%E8%AF%BB%E5%8F%96excel/" title="微信小程序读取excel并上传到云数据库"><img src="https://jsd.012700.xyz/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="微信小程序读取excel并上传到云数据库"/></a><div class="content"><a class="title" href="/2024/03/16/wx-miniprogram%E8%AF%BB%E5%8F%96excel/" title="微信小程序读取excel并上传到云数据库">微信小程序读取excel并上传到云数据库</a><time datetime="2024-03-16T14:36:05.000Z" title="发表于 2024-03-16 22:36:05">2024-03-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/14/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" title="内网渗透"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="内网渗透"/></a><div class="content"><a class="title" href="/2024/03/14/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" title="内网渗透">内网渗透</a><time datetime="2024-03-14T05:45:01.000Z" title="发表于 2024-03-14 13:45:01">2024-03-14</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 By Tang ShunHai</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Welconme to my blog</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>